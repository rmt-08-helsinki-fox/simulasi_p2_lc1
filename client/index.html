<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- UIkit CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.5.4/dist/css/uikit.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css">
    <link rel="stylesheet" href="style.css">

    <title>My Gallery</title>
</head>
<body>
    <!-- LOGIN - PAGE -->
    <section id="login-page">
        <div class="bg-video">
            <video class="bg-video-content" autoplay muted loop>
                <source src="img/video.mp4" type="video/mp4">
                <source src="img/video.webm" type="video/webm">
                    your browser is not supported
            </video>
        </div>
        <div class="center">
            <h1 style="margin-bottom: 3rem;" class="welcome">Welcome To My Gallery</h1>
            <form>
                <div class="uk-margin">
                    <div class="uk-inline">
                        <span class="uk-form-icon" uk-icon="icon: user"></span>
                        <input id="email" class="uk-input" type="email" placeholder="email here">
                    </div>
                </div>
            
                <div class="uk-margin">
                    <div class="uk-inline">
                        <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
                        <input id="password" class="uk-input" type="password" placeholder="password here">
                    </div>
                </div>
                <button type="submit" class="login-btn uk-button uk-button-primary">Login</button>
            
            </form>            
        </div>
    </section>

    <!-- MAIN PAGE -->
    <section id="main-page">
        <nav class="uk-navbar-container navbar-custom" uk-navbar>
            <div class="uk-navbar-left">
        
                <ul class="uk-navbar-nav">
                    <li>
                        <a href="#"><i class="logo fas fa-camera-retro"></i></a>
                    </li>
                    <li><a href="#">My Gallery</a></li>
                </ul>
        
            </div>
            <div class="uk-navbar-right">
        
                <ul class="uk-navbar-nav">
                    <li>
                        <a href="#">Logout</a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- HOME -SECTION -->

        <section id="home-page">

            <!-- CARD -->
            <div class="card-custom uk-card uk-card-default uk-card-hover uk-card-body">
                <i class="bookmark far fa-plus-square"></i>
                <img src="https://images.unsplash.com/photo-1587613753310-0ba642887227?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&ixid=eyJhcHBfaWQiOjE0MTc4MH0" alt="image">
            </div>

        </section>

        <!-- GALLERY - SECTION -->

        <section id="my-gallery-page">
            
            <!-- CARD -->
            <div class="card-custom uk-card uk-card-default uk-card-hover uk-card-body">
                <i class="trash far fa-minus-square"></i>
                <img src="https://images.unsplash.com/photo-1587613753310-0ba642887227?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&ixid=eyJhcHBfaWQiOjE0MTc4MH0" alt="image">
            </div>

        </section>
    </section>
    
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.5.4/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.5.4/dist/js/uikit-icons.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script>
        const baseUrl = `http://localhost:3000`
        function auth(){
            if (localStorage.access_token){
                $('#home-page').show()
            } else {
                const email = $("#email").val()
                const password = $("#password").val()
                $.ajax({
                    url: `${baseUrl}/users/login`,
                    method: 'POST',
                    data: {
                        email: email,
                        password: password
                    }
                })
                .done(response => {
                    localStorage.setItem("access_token") = response.access_token
                    $('#home-page').show()
                })
                .fail(error => {
                    console.log(err)
                })
                .always(_ => {
                    $('#login-page').trigger(reset)
                })
            }
        }

        $(document).ready(() => {
            auth()
        })
    </script>
</body>
</html>